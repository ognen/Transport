<!doctype html>
<html>

<head>
    <meta charset="utf-8">

    <title>Transport API</title>

    <!--[if lt IE 9]><script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <link rel="stylesheet" href="media/bootstrap/css/bootstrap.min.css" />
    <link rel="stylesheet" href="media/css/layout.css" />
</head>

<body lang="en">
    <div class="wrapper">
        <header>
            <h1>Transport</h1>
            <p>Swiss public transport API 2.0 (draft 3)</p>
        </header>

        <article>
            <h2>Introduction</h2>

            <p>The Transport API allows interested developers to build their own applications using public timetable data, whether they're on the web, the desktop or mobile devices. Find out more about how you can start exploring the timetable data playground or just browse the API Documentation.</p>

            <p>The source code can be found on <a href="https://github.com/OpendataCH/Transport">GitHub</a>, please ask any technical questions there. If you need a direct contact write a mail to <a href="mailto:transport@opendata.ch">transport@opendata.ch</a>.</p>

            <h2 id="examples">Examples</h2>

            <p>A few examples to show what can be produced with the Transport API:</p>
            <ul>
            	<li>
            		<a href="examples/stationboard.html">Stationboard table with autocompletion</a>
            	</li>
            	<li>
            	    <a href="examples/connections.php">Connections search</a>
            	</li>
            </ul>
            <h2 id="documentation">API Documentation</h2>

            <ul>
                <li>
                    <a href="#general">General</a>
                    <ul>
                        <li><a href="#hyperlinks">Hyperlinking and Discovery</a></li>
                        <li><a href="#metadata">Metadata and Extensibility</a></li>
                    </ul>
                </li>
                <li>
                    <a href="#api-resources">Resources</a>
                    <ul>
                        <li><a href="#root">Root resource</a> <em>(required)</em></li>
                        <li><a href="#locations">Locations resource</a> <em>(required)</em></li>
                        <li><a href="#connections">Connections resource</a> <em>(optional)</em></li>
                        <li><a href="#stationboard">Stationboard resource</a> <em>(optional)</em></li>
                        <li><a href="#trip-resource">Trip resource</a> <em>(optional)</em></li>
                    </ul>
                </li>
                <li>
                    <a href="#api-objects">Objects</a>
                    <ul>
                        <li><a href="#response">response</a></li>
                        <li><a href="#link">link</a></li>
                        <li><a href="#location">location</a></li>
                        <li><a href="#coordinates">coordinates</a></li>
                        <li><a href="#connection">connection</a></li>
                        <li><a href="#checkpoint">checkpoint</a></li>
                        <li><a href="#timing">timing</a></li>
                        <li><a href="#stop">stop</a></li>
                        <li><a href="#trip">trip</a></li>
                    </ul>
                </li>
                <li>
                    <a href="#enumerations">Enumerations</a>
                    <ul>
                        <li><a href="#location-types">Location Types</a></li>
                        <li><a href="#coordinate-systems">Coordinate Systems</a></li>
                    </ul>
                </li>
                <li>
                    <a href="#limit-response">Limit response</a>
                </li>
            </ul>

            <h3 id="general">General</h3>
            <hr/>

            <h3 id="hyperlinks">Hyperlinking and Discovery</h3>

            <p>The V2 API stipulates that all navigation from responses to new requests
            <strong>should</strong> be done by reading and interpreting the embedded links in the JSON objects.</p>

            <p>E.g. if one knows the id of a station (e.g. <code>4556</code>), one is not allowed to immediately
            construct the URL <code>/stationboard?id=4556</code> but should follow the embedded 
            stationboard link in the response obtained by querying <em>locations</em> endpoint.</p>

            <p>The encoding of links is explained in the <a href="#link">link object section</a>.</p>



            <h3 id="metadata">Metadata and Extensibility</h3>

            <p>Implementations of this specification should be able to extend the
            <a href="#objects">specified objects</a> with data that is unique to them,
            and at the same time they should not confuse client of the API with properties
            that mean one thing in one implementation and other in other.</p>

            <p>To support this, fhe following rules are followed:</p>
            <ul>
                <li>we distinguish between <strong>global identifier</strong> and <strong>namespaced identifiers</strong></li>

                <ul>
                    <li>a <em>global identifier</em> is a plain name (that doesn't contain the 
                        <code>/</code> character)</li>
                    
                    <li>a <em>namespaced identifier</em> is in the form <code>namespace/localName</code></li>
                </ul>

                <li>all global identifiers for <a href="#objects">object</a> properties and 
                    <a href="#enumerations">enumeration values</a> are reserved for the specification,
                    implementations can add <em>only namespaced</em> properties to the specified objects
                    also extend the <a href="#enimerations">enumerations</a> olny with <em>namespaced
                    values</em></li>.

                <li>Client implementations <strong>must</strong> properties that they know nothing about.</li>
            </ul>

            <p>For example:</p>        

            <pre>
{
    "locations": [
        {
            "coordinate": {
                "type": "WGS84",
                "x": "8540192",
                "y": "47378177"
            },
            "id": "008503000",
            "name": "Zuerich",
            "type": "com.example/terminal",
            "com.example/platforms": [
                {
                    "name": "1",
                },
                {
                    "name": "2",
                }
            ]
            "score": "100"
        }
    ]
}
            </pre>

            <p>Here, the implementation extended the <em>station object</em> with a custom property
            <code>com.example/platforms</code>. It also declares the type of the of the location as
            <code>com.example/terminal</code>, i.e. has extended the location types enumeration 
            with a new type.</p>

            <h3 id="api-resources">API Resources</h3>

            <p>The Transport API builds on REST style resources which respond
            <in JSON. Individual resources are detailed below.</p>

            <hr/>

            <h3 id="root">Root Resource</h3>

            <p>The root resource is used as <em>the only entry point in the API</em>. Implementations 
            publish just this URL. It's primary concern is to reveal the <em>capabilities of the api
            provider</em>.</p>

            <p>This resource is required for implementation</p>

            <h4>Resource URL</h4>

            <pre>http://transport.opendata.ch/v2</pre>
            <p><em>(for the reference implementation)</em></p>

            <h4>Request Parameters</h4>

            <p><em>None.</em></p>

            <h4>Response Object</h4>
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>Property Name</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>version</code></td>
                        <td>The version of the API that the implementation provides.</td>
                    </tr>

                    <tr>
                        <td><code>author</code></td>
                        <td>Identifies who implements thi API.</td>
                    </tr>

                    <tr>
                        <td><code>locations</code></td>
                        <td>a <a href="#link">link</a> object pointing to the global 
                            <a href="#locations">resource</a>. <strong>Required.</strong></td>
                    </tr>

                    <tr>
                        <td><code>stationboard</code></td>
                        <td>a <a href="#link">link</a> object pointing to the global 
                            <a href="#stationboard">stationboard</a> resource. <strong>Optional</strong></td>
                    </tr>

                    <tr>
                        <td><code>connections</code></td>
                        <td>a <a href="#link">link</a> object pointing to the 
                        <a href="#connections">connections</a> resourcer. <strong>Optional.</strong></td>
                    </tr>
                </tbody>
            </table>

            <h4>Example Request</h4>
            <pre>GET http://transport.opendata.ch/v2</pre>

            <h4>Example Response</h4>
            <pre>
{
    "author": "Opendata.ch",
    "version": "2.0",
    "locations": { "href": "/v2/locations" },
    "stationboard": { "href": "/v2/stationboard" },
    "connections": { "href": "/v2/connections" }

}                
            </pre>

            <p>In this example we can see that the server implements all the resources of the API.</p>

            <hr/>
            <h3 id="locations">Locations Resource</h3>

            <p>Returns the matching locations for the given parameters.</p>

            <p>This resource is required for implementation.</p>

            <p>The locations in the response are scored to determine which is the most exact location.</p>

            <p>There can be many locations resources: a global one is required (obtained through the <a href="#root">root resource</a>), but implementations may provide finer-grained resources, 
            e.g. <em>locations resources per locality</em>.</p>

            <p><em class="remark">(note: is this necessary? we could just return 404)</em> This method can return a refine response, what means that the request has to be redone.</p>

            <h4>Resource URL</h4>

            <p><em>Obtained by following a <code>locations</code> <a href="#link">link</a>,
            from the <a href="#root">root response</a> or a <a href="#location">location object</a>.</em></p>

            <h4>Request Parameters</h4>

            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Required</th>
                        <th>Description</th>
                        <th>Example</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>query</code></td>
                        <td>required</td>
                        <td>Specifies the location name to search for</td>
                        <td>Basel</td>
                    </tr>
                    <tr>
                        <td><code>x</code></td>
                        <td>optional</td>
                        <td>the x coordinate (of a spatial query)</td>
                        <td>47.476001</td>
                    </tr>
                    <tr>
                        <td><code>y</code></td>
                        <td>optional</td>
                        <td>the y coordinate of a spatial query</td>
                        <td>8.306130</td>
                    </tr>
                    <tr>
                        <td><code>type</code></td>
                        <td>optional</td>
                        <td>
                            Specifies the <a href="#location-types">location type</a>
                            If omitted, the query will search <em>all known location types</em>
                        </td>
                        <td>address</td>
                    </tr>
                    <tr>
                        <td><code>ct</code></td>
                        <td>optional</td>
                        <td>The <a href="#coordinate-systems">coordinate system</a> for 
                            <code>x</code> and <code>y</code>. Defaults to <code>WGS84</code></td>
                        <td>CH1903</td>
                    </tr>
                </tbody>
            </table>

            <h4>Response Properties</h4>

            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>about</code></td>
                        <td>An <em>optional</em> <a href="#location">object</a>, that identifies 
                        the restricted scope of the quieried response. The global resource will omit it
                        but the a locations resource for a <em>locality</em> <strong>should</strong> 
                        return that locality.
                         </td>
                    </tr>
                    <tr>
                        <td><code>locations</code></td>
                        <td>A list of <a href="#location">locations</a></td>
                    </tr>
                </tbody>
            </table>

            <h4>Example Request</h4>

            <pre>GET http://transport.opendata.ch/v2/locations?query=Basel</pre>

            <h4>Example response</h4>

            <pre>
{
    "locations": [
        {
            "coordinate": {
                "type": "WGS84",
                "x": "8540192",
                "y": "47378177"
            },
            "id": "008503000",
            "type": "station",
            "name": "Zuerich",
            "score": "100",
            "stationboard": { "href": "stationboard/008503000" }
        },
        {
            "coordinate": {
                "type": "WGS84",
                "x": "8540192",
                "y": "47378177"
            },
            "id": "008503000",
            "name": "Zurich",
            "score": "99"
            "type": "locality",
            "locations": { "href": "./008503000" }
        }
    ]
}
            </pre>

            <h4>Example Request (refined)</h4>

            <pre>GET http://transport.opendata.ch/v2/locations/008503000?query=Zypressen</pre>

            <p><em>URL obtained from prevous example, points to a locations resource for the 
                Zürich locality.</em></p>

            <h4>Example response (refined)</h4>

            <pre>
{
    "about": {
            "coordinate": {
                "type": "WGS84",
                "x": "8540192",
                "y": "47378177"
            },
            "id": "008503000",
            "name": "Zurich",
            "type": "locality",
            "locations": { "href": "./008503000" }
    },
    "locations": [
        {
            "coordinate": {
                "type": "WGS84",
                "x": "8540192",
                "y": "47378177"
            },
            "id": "008503000",
            "score": "99",
            "type": "station",
            "name": "Zypressenstrasse",
            "stationboard": { "href": "../stationboard/008503000" }
        }
    ]
}
            </pre>

            <hr/>

            <h3 id="connections">Connections resource</h3>

            <p>Returns the next connections from a location to another.</p>

            <p>This resource is optional for implementation.</p>

            <h4>Resource URL</h4>

            <p><em>Obtained by following a <code>connections</code> <a href="#link">link</a>,
            from the <a href="#root">root response</a>.</em></p>


            <h4>Request Parameters</h4>

            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Required</th>
                        <th>Description</th>
                        <th>Example</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>from</code></td>
                        <td>required</td>
                        <td>Specifies the departure location of the connection</td>
                        <td>Lausanne</td>
                    </tr>
                    <tr>
                        <td><code>to</code></td>
                        <td>required</td>
                        <td>Specifies the arrival location of the connection</td>
                        <td>Genève</td>
                    </tr>
                    <tr>
                        <td><code>via</code></td>
                        <td>optional</td>
                        <td class="description">Specifies up to five via locations. When specifying several vias, array notation (<code>via[]=via1&amp;via[]=via2</code>) is required.</td>
                        <td>Bern</td>
                    </tr>
                    <tr>
                        <td><code>date</code></td>
                        <td>optional</td>
                        <td>Date of the connection, in the format YYYY-MM-DD</td>
                        <td>2012-03-25</td>
                    </tr>
                    <tr>
                        <td><code>time</code></td>
                        <td>optional</td>
                        <td>Time of the connection, in the format hh:mm</td>
                        <td>17:30</td>
                    </tr>
                    <tr>
                        <td><code>isArrivalTime</code></td>
                        <td>optional</td>
                        <td>defaults to <code>0</code>, if set to <code>1</code> the passed <code>date</code> and <code>time</code> is the arrival time</td>
                        <td>1</td>
                    </tr>
                    <tr>
                        <td><code>categories</code></td>
                        <td>optional</td>
                        <td class="description">Transportation means (categories); one or more of <a href="#transport-categories">these</a>.</td>
                        <td>categories[]=ec_ic&amp;categories[]=bus</td>
                    </tr>
                    <tr>
                        <td><code>limit</code></td>
                        <td>optional</td>
                        <td>1 - 6. Specifies the number of connections to return. If several connections depart at the same time they are counted as 1.</td>
                        <td>Bern</td>
                    </tr>
                    <tr>
                        <td><code>page</code></td>
                        <td>optional</td>
                        <td>0 - 10. Allows pagination of connections. Zero-based, so first page is&#160;0, second is&#160;1, third is&#160;2 and so on.</td>
                        <td>3</td>
                    </tr>
                    <tr>
                        <td><code>direct</code></td>
                        <td>optional</td>
                        <td>defaults to 0, if set to 1 only direct connections are allowed</td>
                        <td>1</td>
                    </tr>
                    <tr>
                        <td><code>sleeper</code></td>
                        <td>optional</td>
                        <td>defaults to 0, if set to 1 only night trains containing beds are allowed, implies direct=1</td>
                        <td>1</td>
                    </tr>
                    <tr>
                        <td><code>couchette</code></td>
                        <td>optional</td>
                        <td>defaults to 0, if set to 1 only night trains containing couchettes are allowed, implies direct=1</td>
                        <td>1</td>
                    </tr>
                    <tr>
                        <td><code>bike</code></td>
                        <td>optional</td>
                        <td>defaults to 0, if set to 1 only trains allowing the transport of bicycles are allowed</td>
                        <td>1</td>
                    </tr>
                </tbody>
            </table>

            <h4>Response parameters</h4>

            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>connections</code></td>
                        <td>A list of <a href="#connection">connections</a></td>
                    </tr>
                </tbody>
            </table>

            <h4>Example Requests</h4>

            <pre>GET http://transport.opendata.ch/v2/connections?from=Lausanne&amp;to=Genève</pre>
            <p>which is the same as</p>
            <pre>GET http://transport.opendata.ch/v2/connections?from=008501120&amp;to=008501008</pre>

            <h4>Example response</h4>

            <pre>
{
    "connections" : [
        {
            "from" : {
                "arrival" : null,
                "departure" : "2012-03-31T08:58:00+02:00",
                "platform" : "7",
                "prognosis" : {
                    "platform" : null,
                    "arrival" : null
                    "departure" : null
                    "capacity1st" : "-1",
                    "capacity2nd" : "-1",
                },
                "station" : {
                    "coordinate" : {
                        "type" : "WGS84",
                        "x" : "6629086",
                        "y" : "46516785"
                    },
                    "id" : "008501120",
                    "name" : "Lausanne",
                    "score" : null
                }
            },
            "to" : {
                "arrival" : "2012-03-31T09:46:00+02:00",
                "departure" : null,
                "platform" : "2",
                "prognosis" : {
                    "platform" : null,
                    "arrival" : null,
                    "departure" : null
                    "capacity1st" : null,
                    "capacity2nd" : null,
                },
                "station" : {
                    "coordinate" : {
                        "type" : "WGS84",
                        "x" : "6142437",
                        "y" : "46210217"
                    },
                    "id" : "008501008",
                    "name" : "Genève",
                    "score" : null
                }
            }
        },
    ],
    // ...
}
            </pre>
            <hr/>

            <h3 id="stationboard">Stationboard resource</h3>

            <p>Returns departures leaving from a specific location.</p>

            <p>This resource is optional for implementation</p>

            <h4>Resource URL</h4>

            <p><em>Obtained by following a <code>stationboard</code> <a href="#link">link</a>,
            from the <a href="#root">root response</a> or a <a href="#location">location object</a>.</em></p>


            <h4>Request Parameters</h4>

            <table class="table table-bordered">
                <thead>
                <tr>
                    <th>Name</th>
                    <th>Required</th>
                    <th>Description</th>
                    <th>Example</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td><code>station</code></td>
                    <td>optional</td>
                    <td>
                        <em class="remark">(I think this is unnecessary, as station lookup should
                         go through the locations resources)</em> 
                         <p>Specifies the location of which a stationboard should be returned.</p>
                         <p>Either a <code>station</code> or an <code>id</code> should be provided,
                            unless the stationboard URL was obtained through a link inside a 
                            <a href="#location">location object</a>, in which case the stationboard is 
                            <strong>just for that location</strong></p>
                    </td>
                    <td>Aarau</td>
                </tr>
                <tr>
                    <td><code>id</code></td>
                    <td>optional</td>
                    <td><p>The id of the station whose stationboard should be returned.</p>
                        <p>Alternative to the station parameter; one of these two is should be provided..</p>
                        <p>Either a <code>station</code> or an <code>id</code> should be provided,
                            unless the stationboard URL was obtained through a link inside a 
                            <a href="#location">location object</a>, in which case the stationboard is 
                            <strong>just for that location</strong> and the id is unnecessary.</p>
                    </td>
                    <td>8503059 <em>(for Zurich Stadelhofen)</em></td>
                </tr>
                <tr>
                    <td><code>limit</code></td>
                    <td>optional</td>
                    <td><p>Number of departing connections to return.</p>
                        <p>This is not a hard limit - if multiple connections leave at the same time it'll return any connections that leave at the same time as the last connection within the limit.<br />
                        For example: limit=4 will return connections leaving at :
                        <ul><li>19:30</li><li>19:32</li><li>19:32</li><li>19:35</li><li>19:35</li></ul>
                        Because one of the connections leaving at 19:35 is within the limit, all connections leaving at 19:35 are shown.</p>
                        <em>It's up to the implementation to chose a default value.</em>
                    </td>
                    <td>15</td>
                </tr>
                <tr>
                    <td><code>from</code></td>
                    <td>optional</td>
                    <td>A RFC3339 timestamp, determining from which point in time we are interested in looking at connections.</td>
                    <td>2012-03-31T08:58:00+02:00</td>
                </tr>
                <tr>
                    <td><code>to</code></td>
                    <td>optional</td>
                    <td>A RFC3339 timestamp, determining until which point in time we are interested in lookin at connections.</td>
                    <td>2012-03-31T08:58:00+02:00</td>
                </tr>
                <tr>
                    <td><code>categories</code></td>
                    <td>optional</td>
                    <td class="description">Transportation means (categories); one or more of <a href="#transport-categories">these</a>.</td>
                    <td>?categories[]=ec_ic&amp;categories[]=bus</td>
                </tr>
                <tr>
                    <td><code>lines</code></td>
                    <td>optional</td>
                    <td>Which lines should the quiery return. <em>Default: all</em></td>
                    <td>?lines[]=2&amp;lines[]=3</td>
                </tr>
                </tbody>
            </table>

            <h4>Interpreting the <code>limit</code>, <code>from</code>, to <code>parameters</code></h4>

            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>from</th>
                        <th>to</th>
                        <th>limit</th>
                        <th>Meaning</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>n/a</td>
                        <td>n/a</td>
                        <td>n/a</td>
                        <td>Return the default number of stops matching the filtering criteria, starting from now.
</td>
                    </tr>
                    <tr>
                        <td>provided</td>
                        <td>n/a</td>
                        <td>n/a</td>
                        <td>Return the default number of stops matching the filtering criteria, starting from the provided time.</td>
                    </tr>
                    <tr>
                        <td>provided</td>
                        <td>n/a</td>
                        <td>provided</td>
                        <td>Return the specified no. of connections matching the filtering criteria, starting from now.</td>
                    </tr>
                    <tr>
                        <td>provided</td>
                        <td>provided</td>
                        <td>provided</td>
                        <td>Return up to the specified no. of connection matching the filtering criteria, starting from given time and no latter to the given end time.</td>
                    </tr>
                    <tr>
                        <td>n/a</td>
                        <td>provided</td>
                        <td>n/a</td>
                        <td>Return up to the default number of stops from now to (at most) the provided <em>to</em> value.</td>
                    </tr>
                    <tr>
                        <td>provided</td>
                        <td>provided</td>
                        <td>n/a</td>
                        <td>Return up to the default number of stops from <em>from</em>  to (at most) <em>to</em>.</td>

                    </tr>
                </tbody>
            </table>

            <p><em>(one should be able to deduce the rest of the possible cases based on these)</em></p>

            <h4>Interpreting the filtering parameters: <code>categories</code> and <code>lines</code></h4>

            <p>When more than one filtering parameter of any kind is present, the matching criteria would means a a connection that matches any of the provided parameters. I.e. </p>

            <pre>categories[]=ship&amp;lines[]=2&amp;lines[]=3</pre>

            <p>should be interpreted as all connections of the lines 2 and 3 and also ships should be returned.</p>

            <h4>Response parameters</h4>

            <table class="table table-bordered">
                <thead>
                <tr>
                    <th>Name</th>
                    <th>Description</th>
                </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>about</code></td>
                        <td>a <a href="#location">location object</a> identifying to what the response relates to.</td>
                    </tr>
                    <tr>
                        <td><code>stationboard</code></td>
                        <td>A list of <a href="#stop">stops</a>, showing the requested departures.</td>
                    </tr>
                </tbody>
            </table>

            <h4>Example Requests</h4>

            <pre>GET http://transport.opendata.ch/v2/stationboard?station=Aarau&amp;limit=10</pre>
            <p>which is the same as</p>
            <pre>GET http://transport.opendata.ch/v2/stationboard?id=8502996&amp;limit=10</pre>
            <p>which is also</p>
            <pre>GET http://transport.opendata.ch/v2/stationboard/8502996?limit=10</pre>

            <h4>Example response</h4>

            <pre>
{
    "about":
    {
        "id": "8502996",
        "type": "station",
        "stationboard": { "href": "./8502996" },
        "name": "Aarau, Bahnhof",
        "coordinates":
        {
            "type" : "WGS84",
            "x": "8050864",
            "y": "47392020"
        },
    },
    "stationboard" : [
    {
        "station":
        {
            "id": "8502996",
            "type": "station",
            "stationboard": { "href": "./8502996" },
            "name": "Aarau, Bahnhof",
            "coordinates":
            {
                "type" : "WGS84",
                "x": "8050864",
                "y": "47392020"
            },
        },
        "trip":
        {
            "href": "/v2/trips/1234567",
            "category": "bus",
            "number": "3",
            "operator": "VBZ",
            "direction": "Frick, Bahnhof"
        },
        "plan":
        {
            "arrival": null,
            "departure": "2012-03-31T14:39:00+02:00",
            "platform": "", 
            "capacity1st": "-1",
            "capacity2nd": "-1"
        },
        "prognosis":
        {
            "platform": null,
            "arrival": null,
            "departure": "2012-03-31T14:39:44+02:00",
            "capacity1st": "-1",
            "capacity2nd": "-1"
        }
    },
    {
        "station":
        {
            "id": "8502996",
            "stationboard": { "href": "./8502996" },
            "name": "Aarau, Bahnhof",
            "coordinates":
            {
                "type": "WGS84",
                "x": "8050864",
                "y": "47392020"
            }
        },
        "trip": 
        {
            "href": "/v2/trips/123459",
            "category": "bus",
            "number": "2",
            "operator": "BBA",
            "direction": "Aarau Rohr, Unterdorf"
        },
        "plan":
        {
            "arrival": null,
            "departure": "2012-03-31T14:39:00+02:00",
            "platform": ""
        },
        "prognosis":
        {
            "platform": null,
            "arrival": null,
            "departure": "2012-03-31T14:39:00+02:00",
            "capacity1st": "-1",
            "capacity2nd": "-1"
        }
    }
    // ...
    ]
}
            </pre>

            <hr/>

            <h3 id="trip-resource">Trip resource</h3>

            <p>Returns a trip, which is a single traversal that a transportation vehicle performs over its 
                usual route.</p>

            <p>This resource is optional for implemetation.</p>

            <h4>Resource URL</h4>
            <p><em>Obtained by following a <code>trip</code> <a href="self-link">self-link</a>
                from a <a href="#stop">stop object</a>.</em></p>

            <h4>Request Parameters</h4>
            <p><em>None.</em></p>

            <h4>Response Parameters</h4>

            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>about</code></td>
                        <td>a <a href="#trip">trip object</a> identifying the trip itself.</td>
                    </tr>
                    <tr>
                        <td><code>stops</code></td>
                        <td>
                            <p>a list of <a href="#stop">stops</a> outlining the route of the trip,
                                the timing as well as real-time information.</p>

                            <p>Note that, because all stops are related to a single trip,
                                <em>the <code>trip</code> property will be <strong>omitted</strong> 
                                from the stops</em>. Use the <code>about</code> property.</p>
                        </td>
                    </tr>
                </tbody>
            </table>

            <h4>Example Request</h4>

            <pre>GET http://transport.opendata.ch/v2/trips/987654</pre>

            <h4>Example Response</h4>

            <pre>
{
    "about":
    {
        "id": "987654",
        "href": "/v2/trips/987654",
        "category": "bus",
        "number": "3",
        "operator": "VBZ",
        "direction": "Frick, Bahnhof"
    },
    "stops" : [
    {
        "station":
        {
            "id": "8502996",
            "type": "station",
            "stationboard": { "href": "./8502996" },
            "name": "Aarau, Bahnhof",
            "coordinates":
            {
                "type" : "WGS84",
                "x": "8050864",
                "y": "47392020"
            },
        },
        "plan":
        {
            "arrival": null,
            "departure": "2012-03-31T14:39:00+02:00",
            "platform": "", 
            "capacity1st": "-1",
            "capacity2nd": "-1"
        },
        "prognosis":
        {
            "platform": null,
            "arrival": null,
            "departure": "2012-03-31T14:39:44+02:00",
            "capacity1st": "-1",
            "capacity2nd": "-1"
        }
    },
    {
        "station":
        {
            "id": "8502996",
            "stationboard": { "href": "./8502996" },
            "name": "Aarau, Bahnhof",
            "coordinates":
            {
                "type": "WGS84",
                "x": "8050864",
                "y": "47392020"
            }
        },
        "plan":
        {
            "arrival": null,
            "departure": "2012-03-31T14:39:00+02:00",
            "platform": ""
        },
        "prognosis":
        {
            "platform": null,
            "arrival": null,
            "departure": "2012-03-31T14:39:00+02:00",
            "capacity1st": "-1",
            "capacity2nd": "-1"
        }
    }
    // ...
    ]
}                
            </pre>
            <hr/>

            <h3 id="api-objects">API Objects</h3>

            <p>API responses are composites of the following objects:</p>

            <h4 id="response">Response objects</h4>

            <p>Response objects differ from resource to resource but each of them follows the 
            these rules:</p>

            <ul>
                <li>The response is always a JSON object (not an array)</li>
                <li>The response object has a property contain the main response body (mandatory).
                    Each resource specifies which property is the main response body</li>
                <li>The response object conains an optiona header property. Each resource 
                    specifies which property is the header, if any. Usually this property is called
                    <code>about</code></li>
                <li>The response object may contain optional <a href="#metadata">metadata</a></li>
            </ul>

            <p>Example:</p>
            <pre>
{
    "header": {
        "id": "8502996",
        "name": "Aarau, Bahnhof",
        "type": "station",
        "score": null,
        "coordinate":
        {
        "type" : "WGS84",
        "x": "8050864",
        "y": "47392020"
    },
    "stationboard" : [
        {
            "station": {
                "id": "8502996",
                "name": "Aarau, Bahnhof",
                "score": null,
                "coordinate":
                {
                    "type" : "WGS84",
                    "x": "8050864",
                    "y": "47392020"
                },
                "etc": "..."
            },
            "arrival": null,
        },
        {
            "satation": "...",
        }
    ]
}
            </pre>

            <p>Here, the <code>stationboard</code> is the main response body property. 
               The station board response's header property is called <code>header</code>
               and it tells us that for which station this data is about.</p>

            <h4 id="link">Link object</h4>
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>Property name</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>href</code></td>
                        <td>The value of the <code>href</code>
                            property may contain both <em>absolute URIs</em> as well as <em>relative references</em>. These URIs <strong>must be</strong> resolved, as per 
                            <a href="http://tools.ietf.org/html/rfc3986">RFC 3986</a> 
                            (a functionality available in almost every developer toolkit). </td>
                    </tr>
                </tbody>
            </table>

            <p>Any JSON object that contains a property named <code>href</code>
            is considered a <strong>hyperlink</strong>.</p>

            <p>For example, the following object is a link:</p>
            <pre>{ "href": "./stationboard/123456" }</pre>

            <p>The link object can have other properties as well</p>

            <h5>The Relation of the link to its containing object</h5>

            <p>The meaining of a link is always determined <em>in relation</em> with its containing
            object. The relation between the containing object and the embedded link si given 
            <em>by the property name</em> under which the link is contained within the parent.</p>

            <p>For example, in the object:</p>

            <pre>
{
    "name": "Zurich HB",
    "type": "station",
    "stationboard": { "href": "./stationboard/123456" }
}
            </pre>

            <p>We interpret that the (relative) URI <code>./stationboard/123456</code> <em>points
            to a stationboard for the station Zurich HB</em> (because the link object is found under
            the property <code>stationboard</code> of the station object named "Zurich HB").</p>

            <p>Similarly</p>
            <pre>
{
    "name": "Zurich",
    "type": "locality",
    "locations": { "href": "./locations/zuerich" }
}
            </pre>

            <p>Is interpreted as <em>the link <code>./locations/zuerich</code> points to 
            a <a href="#locations">locations</a> resource where all the locations within 
            the city of Zürich can be found</em> because the link object is found under a
            <code>locations</code> property inside a the Zurich locality object.</p>

            <h5>Standard Link properties</h5>

            The following property names are <strong>reserved for standard links</strong>.

            <table class="table table-bordered">
                <thead>
                    <th>Property Name</th>
                    <th>Description</th>
                </thead>
                <tbody>
                    <tr>
                        <td><code>stationboard</code></td>
                        <td>Points to a <a href="#stationboard">stationboard</a> resource related to the containing object</td>
                    </tr>
                    <tr>
                        <td><code>locations</code></td>
                        <td>
                            <p>Points to a <a href="#locations">locations</a> resource related to the containing object.</p>
                        </td>
                    </tr>
                    <tr>
                        <td><code>connections</code></td>
                        <td>Points to a <a href="#connections">connections</a> resource related to the containing object.</td>
                    </tr>
                </tbody>
            </table>

            <h5 id="self-link">Self-Links</h5>

            <p>A self-link is an object (also a link) pointing to a resource of the same object, 
            usually in greater details. It is usually used in collection resources (such as 
            trip objects in stationboars to point to the full-version of the trips themselves.</p>

            <p>For example:</p>
            <pre>
{
    "stationboard": [
        {
            "trip": {
                "href": "./trips/123456",
                "line": "2",
                "category": "bus"
            },
            "station": {
                "id": "8502996",
                "name": "Aarau, Bahnhof"
            }
        }
    ]
}
            </pre>

            <p>In this response, the <code>trip</code> object contains a self link (can also be 
            said that <em>it is</em> a self link, because it is an object containin a <code>href</code>
            property) to a resource that represents the full trip.</p>

            <h4 id="location">Location Object</h4>

            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>id</code></td>
                        <td>The id of the location</td>
                    </tr>
                    <tr>
                        <td><code>type</code></td>
                        <td>
                            <a href="#location-types">Type of the location</a>, may also can contain
                            <code>refine</code> which means the location is not defined, the user has 
                            to relocate.
                            <em class="remark">(Is this necessary?)</em>
                            </ul>
                        </td>
                    </tr>
                    <tr>
                        <td><code>name</code></td>
                        <td>The location name</td>
                    </tr>
                    <tr>
                        <td><code>score</code></td>
                        <td>The accuracy of the result</td>
                    </tr>
                    <tr>
                        <td><code>coordinates</code></td>
                        <td>The location <a href="#coordinates">coordinates</a></td>
                    </tr>
                    <tr>
                        <td><code>distance</code></td>
                        <td>If search has been with coordinates, distance to original point in meters</td>
                    </tr>
                    <tr>
                        <td><code>locations</code></td>
                        <td>An (optional) <a href="#link">link</a> to a refined 
                            <a href="#locations">locations resource</a> just for the current location.
                            Usually present for locations of type <code>locality</code> to point to 
                            a resource that lists locations just for that locality (i.e. city).</td>
                    </tr>
                    <tr>
                        <td><code>stationboard</code></td>
                        <td>An (optional) <a href="#link">link</a> to a 
                            <a href="#stationboard">stationboard resource</a> that represents a stationboard
                            just for the current location. Applies only to locations of type <code>station</code></td>
                    </tr>
                </tbody>
            </table>

            <h4 id="coordinates">Coordinates Object</h4>

            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>type</code></td>
                        <td>The type of the given coordinate</td>
                    </tr>
                    <tr>
                        <td><code>x</code></td>
                        <td>Latitude</td>
                    </tr>
                    <tr>
                        <td><code>y</code></td>
                        <td>Longitude</td>
                    </tr>
                </tbody>
            </table>

            <h4 id="connection">Connection Object</h4>

            <p>A connection represents a possible journey between two locations.</p>

            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Description</th>
                        <th>Example</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>from</code></td>
                        <td colspan="2">The departure <a href="#checkpoint"> checkpoint</a> of the connection</td>
                    </tr>
                    <tr>
                        <td><code>to</code></td>
                        <td colspan="2">The arrival <a href="#checkpoint"> checkpoint</a> of the connection</td>
                    </tr>
                    <tr>
                        <td><code>duration</code></td>
                        <td>Duration of the journey</td>
                        <td>00d00:43:00</td>
                    </tr>
                    <tr>
                        <td><code>service</code></td>
                        <td colspan="2"><a href="#service">Service</a> information about how regular the connection operates</td>
                    </tr>
                    <tr>
                        <td><code>products</code></td>
                        <td>Array with transport products</td>
                        <td>IR, S9</td>
                    </tr>
                    <tr>
                        <td><code>capacity1st</code></td>
                        <td>The maximum estimated occupation load of 1st class coaches</td>
                        <td>1</td>
                    </tr>
                    <tr>
                        <td><code>capacity2st</code></td>
                        <td>The maximum estimated occupation load of 2nd class coaches</td>
                        <td>2</td>
                    </tr>
                </tbody>
            </table>

            <h4 id="checkpoint">Checkpoint Object</h4>

            <p><em class="remark">IMHO, the checkpoint and the stop objects are very similar and
                should essentialy be one type of object.</em></p>

            <p>A checkpoint represents an arrival or a departure point (in time and space) of a connection.</p>

            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Description</th>
                        <th>Example</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>station</code></td>
                        <td colspan="2">The <a href="#location">location</a> of the checkpoint</td>
                    </tr>
                    <tr>
                        <td><code>arrival</code></td>
                        <td>The arrival time to the checkpoint</td>
                        <td>14:58:00</td>
                    </tr>
                    <tr>
                        <td><code>departure</code></td>
                        <td>The departure time from the checkpoint</td>
                        <td>null</td>
                    </tr>
                    <tr>
                        <td><code>platform</code></td>
                        <td>The arrival/departure platform </td>
                        <td>8</td>
                    </tr>
                    <tr>
                        <td><code>prognosis</code></td>
                        <td colspan="2">The checkpoint <a href="#timing">prognosis</a></td>
                    </tr>
                </tbody>
            </table>

            <h4 id="service">Service Object</h4>

			<p>Operation information for a connection.</p>

            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Description</th>
                        <th>Example</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>regular</code></td>
                        <td>Information about how regular a connection operates.</td>
                        <td>daily</td>
                    </tr>
                    <tr>
                        <td><code>irregular</code></td>
                        <td>Additional information about irregular operation dates.</td>
                        <td>not 23., 24. Jun 2012</td>
                    </tr>
                </tbody>
            </table>

            <h4 id="timing">Timing Object</h4>

            <p>A timing object contains timing information (arrival, departure, capacity) of a 
                <a href="#stop">stop</a>. or <a href="#connection"></a></p>

            <p>The timing object can be used to represent both <strong>plan</strong> and 
                <strong>realtime</strong> data.

            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Description</th>
                        <th>Example</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>platform</code></td>
                        <td>The plannned/estimated arrival/departure platform</td>
                        <td>8</td>
                    </tr>
                    <tr>
                        <td><code>departure</code></td>
                        <td>The departure time to the checkpoint<br>Date format: <a href="http://en.wikipedia.org/wiki/ISO_8601">ISO 8601</a></td>
                        <td>2012-03-31T08:58:00+02:00</td>
                    </tr>
                    <tr>
                        <td><code>arrival</code></td>
                        <td>The arrival time to the checkpoint<br>Date format: <a href="http://en.wikipedia.org/wiki/ISO_8601">ISO 8601</a></td>
                        <td>2012-03-31T09:35:00+02:00</td>
                    </tr>
                    <tr>
                        <td><code>capacity1st</code></td>
                        <td>The occupation load of 1st class coaches</td>
                        <td>1</td>
                    </tr>
                    <tr>
                        <td><code>capacity2st</code></td>
                        <td>The occupation load of 2nd class coaches</td>
                        <td>2</td>
                    </tr>
                </tbody>
            </table>
        
            <h4 id="stop">Stop Object</h4>
            <p>The stop object represents a stopping of one one trip on a station at a given point in time.</p>

            <table class="table table-bordered">
                <thead>
                <tr>
                    <th>Name</th>
                    <th>Description</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td><code>station</code></td>
                    <td>A <a href="#location">location</a> object showing this line's stop at the requested station.</td>
                </tr>
                <tr>
                    <td><code>trip</code></td>
                    <td>A <a href="#trip">trip</a> object denoting the trip (vehicle) that makes the stop.</td>
                </tr>
                <tr>
                    <td><code>plan</code></td>
                    <td>a <a href="#timing">timing object</a> representing the planned stopping times.</td>
                </tr>
                <tr>
                    <td><code>prognosis</code></td>
                    <td>a <a href="#timing">timing object</a> representing the prognosis over on when this stopping would take place. <strong>Optional.</strong></td>
                </tr>
                </tbody>
            </table>
            
            <h4 id="trip">Trip Object</h4>
            <p>The trip object represents the a single trip performed by a transportation vehicle over its usual route.</p>

            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Description</th>
                        <th>Example</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>id</code></td>
                        <td>The id of the trip.</td>
                    </tr>
                    <tr>
                        <td><code>href</code></td>
                        <td>An URL (<a href="#self-link">self link</a>) pointing to 
                            the complete <a href="trip-resource">trip resource</a>.
                        </td>
                        <td>/v2/trips/9876543</td>
                    </tr>
                    <tr>
                        <td><code>category</code></td>
                        <td>The type of the trip. One of <a href="#transportation-categories">these</a>. </td>
                        <td>bus</td>
                    </tr>
                    <tr>
                        <td><code>number</code></td>
                        <td>The number of the connection's line, e.g. Bus line 2</td>
                        <td>2</td>
                    </tr>
                    <tr>
                        <td><code>operator</code></td>
                        <td>The operator of the connection's line</td>
                        <td>BBA</td>
                    </tr>
                    <tr>
                        <td><code>direction</code></td>
                        <td>The final destination of this line</td>
                        <td>Aarau Rohr, Unterdorf</td>
                    </tr>

                </tbody>
            </table>
        <hr/>

        <h3 id="enumerations">Enumerations</h3>

        <p>Enumerations (constants) used in this specification</p>

        <hr/>

        <h3 id="location-types">Location Types</h3>

        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>station</code></td>
                    <td>A station (train station, bus station)</td>
                </tr>

                <tr>
                    <td><code>poi</code></td>
                    <td>A place of interest (clock tower, china garden)</td>
                </tr>

                <tr>
                    <td><code>address</code></td>
                    <td>An address location type</td>
                </tr>

                <tr>
                    <td><code>locality</code></td>
                    <td>A locality, such as a city or a town (Zürich, Murten).</td>
                </tr>
            </tbody>
        </table>

        <hr/>

        <h3 id="coordinate-systems">Coordinate Systems</h3>

        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>WGS84</code></td>
                    <td>The <a href="http://en.wikipedia.org/wiki/World_Geodetic_System">WGS84</a>
                        coordinate system.</td>
                </tr>

                <tr>
                    <td><code>CH1093</code></td>
                    <td>The <a href="http://en.wikipedia.org/wiki/Swiss_coordinate_system">Swiss
                     coordinate system</a></td>
                </tr>
            </tbody>
        </table>

        <hr/>

        <h3 id="transport-categories">Categories (transportation means)</h3>

        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>ice_tgv_rj</code></td>
                    <td>TBD.</td>
                </tr>
                <tr>
                    <td><code>ec_ic</code></td>
                    <td>TBD.</td>
                </tr>
                <tr>
                    <td><code>ir</code></td>
                    <td>TBD.</td>
                </tr>
                <tr>
                    <td><code>re_d</code></td>
                    <td>TBD.</td>
                </tr>
                <tr>
                    <td><code>ship</code></td>
                    <td>TBD</td>
                </tr>
                <tr>
                    <td><code>s_sn_r</code></td>
                    <td>TBD.</td>
                </tr>
                <tr>
                    <td><code>bus</code></td>
                    <td>A bus.</td>
                </tr>
                <tr>
                    <td><code>cableway</code></td>
                    <td>TBD.</td>
                </tr>
                <tr>            
                    <td><code>arz_ext</code></td>
                    <td>TBD.</td>
                </tr>
                <tr>
                    <td><code>tramway_underground</code></td>
                    <td>Tram or underground.</td>
                </tr>
            </tbody>
        </table>

        <h3 id="limit-response">Limit response</h3>
        <p><em class="remark">IMHO, this is unnecessary and maybe difficuilt to implement use
            as there is no XPath-like standard for JSON.</em></p>

            <p>You can limit the response data with the <code>fields</code> parameter.
            If any <code>fields[]</code> is passed, only the specified fields are in the response.
            The API is aware of the hierarchy, if you set a field, everything below is in the response unless a more specific (further down in the hierarchy) field is set.
            </p>
            <h4>Example Request</h4>

            <pre>GET http://transport.opendata.ch/v1/connections?from=Lausanne&amp;to=Genève&amp;fields[]=connections/from/departure&amp;fields[]=connections/to/arrival</pre>

            <h4>Example response</h4>

            <pre>
{
    "connections":[
        {
            "from":{
                "departure":"2012-05-01T19:42:00+0200",
            },
            "to":{
                "arrival":"2012-05-01T20:15:00+0200",
            }
        },
    ],
    //....
}

            </pre>
            
            
            <h4>Example Request</h4>

            <pre>GET http://transport.opendata.ch/v1/connections?from=Lausanne&amp;to=Genève&amp;fields[]=connections/from&amp;fields[]=connections/to/station</pre>

            <h4>Example response</h4>

            <pre>
            
{
    "connections":[
        {
            "from":{
                "station":{
                    "id":"008501120",
                    "name":"Lausanne",
                    "score":null,
                    "coordinate":{
                        "type":"WGS84",
                        "x":6.629086,
                        "y":46.516785
                    }
                },
                "arrival":null,
                "departure":"2012-05-01T19:42:00+0200",
                "platform":"5",
                "prognosis":{
                    "platform":null,
                    "arrival":null,
                    "departure":null,
                    "capacity1st":"1",
                    "capacity2nd":"1"
                }
            },
            "to":{
                "station":{
                    "id":"008501008",
                    "name":"Gen\u00e8ve",
                    "score":null,
                    "coordinate":{
                        "type":"WGS84",
                        "x":6.142437,
                        "y":46.210217
                    }
                }
            }
        },
    ],
    // ...
}
            </pre>

        </article>

        <footer>
            <p>Powered by <a href="http://opendata.ch/">Opendata.ch</a></p>
        </footer>
    </div>
</body>
</html>
